\documentclass{sigchi}

% Use this section to set the ACM copyright statement (e.g. for
% preprints).  Consult the conference website for the camera-ready
% copyright statement.

% Copyright
\CopyrightYear{2023}
%\setcopyright{acmcopyright}
\setcopyright{acmlicensed}
%\setcopyright{rightsretained}
%\setcopyright{usgov}
%\setcopyright{usgovmixed}
%\setcopyright{cagov}
%\setcopyright{cagovmixed}
% DOI
\doi{https://doi.org/10.1145/3313831.XXXXXXX}
% ISBN
\isbn{978-1-4503-6708-0/20/04}
%Conference
\conferenceinfo{CHI'20,}{April  25--30, 2020, Honolulu, HI, USA}
%Price
\acmPrice{\$15.00}

% Use this command to override the default ACM copyright statement
% (e.g. for preprints).  Consult the conference website for the
% camera-ready copyright statement.

%% HOW TO OVERRIDE THE DEFAULT COPYRIGHT STRIP --
%% Please note you need to make sure the copy for your specific
%% license is used here!
\toappear{
	Permission to make digital or hard copies of all or part of this work
	for personal or classroom use is granted without fee provided that
	copies are not made or distributed for profit or commercial advantage
	and that copies bear this notice and the full citation on the first
	page. Copyrights for components of this work owned by others than the author
	must be honored. Abstracting with credit is permitted. To copy
	otherwise, or republish, to post on servers or to redistribute to
	lists, requires prior specific permission and/or a fee.% Request
	% permissions from \href{mailto:ellinas@kth.se}{ellinas@kth.se}. \\
	% \emph{CHI '16},  May 07--12, 2016, San Jose, CA, USA \\
	% ACM xxx-x-xxxx-xxxx-x/xx/xx\ldots \$15.00 \\
	% DOI: \url{http://dx.doi.org/xx.xxxx/xxxxxxx.xxxxxxx}
	}
	% \toappear{}

% Arabic page numbers for submission.  Remove this line to eliminate
% page numbers for the camera ready copy
% \pagenumbering{arabic}

% Load basic packages
\usepackage{balance}       % to better equalize the last page
\usepackage{graphics}      % for EPS, load graphicx instead 
\usepackage[T1]{fontenc}   % for umlauts and other diaeresis
\usepackage{txfonts}
\usepackage{mathptmx}
\usepackage[pdflang={en-US},pdftex]{hyperref}
\usepackage{color}
\usepackage{booktabs}
\usepackage{textcomp}
\usepackage{tikz}
\usepackage{amsmath}
\usepackage{xintexpr}
\usetikzlibrary {arrows, shapes, automata, positioning, math, calc, external, decorations.pathreplacing, calligraphy}

\input{figures/common-tikz.tex}
\tikzset{
	beginning/.pic={
		\draw [pic actions] (0,0) -- (1,1) -- (3,1) -- (3,0) -- (0,0);
	}
}

\tikzset{
	end/.pic={
		\draw [pic actions] (0,0) -- (1,0) -- (0,1) -- (0,0);
	}
}

% Some optional stuff you might like/need.
\usepackage{microtype}        % Improved Tracking and Kerning
% \usepackage[all]{hypcap}    % Fixes bug in hyperref caption linking
\usepackage{ccicons}          % Cite your images correctly!
% \usepackage[utf8]{inputenc} % for a UTF8 editor only

\usepackage{todonotes}

% Paper metadata (use plain text, for PDF inclusion and later
% re-using, if desired).  Use \emtpyauthor when submitting for review
% so you remain anonymous.
\def\plaintitle{Performing string multiphonics on any pitched sound}
\def\plainauthor{Dimitrios Aatos Ellinas}
\def\emptyauthor{}
\def\plainkeywords{physical modelling; audio features}
\def\plaingeneralterms{Documentation, Standardization}

% llt: Define a global style for URLs, rather that the default one
\makeatletter
\def\url@leostyle{%
  \@ifundefined{selectfont}{
    \def\UrlFont{\sf}
  }{
    \def\UrlFont{\small\bf\ttfamily}
  }}
\makeatother
\urlstyle{leo}

% To make various LaTeX processors do the right thing with page size.
\def\pprw{8.5in}
\def\pprh{11in}
\special{papersize=\pprw,\pprh}
\setlength{\paperwidth}{\pprw}
\setlength{\paperheight}{\pprh}
\setlength{\pdfpagewidth}{\pprw}
\setlength{\pdfpageheight}{\pprh}

% Make sure hyperref comes last of your loaded packages, to give it a
% fighting chance of not being over-written, since its job is to
% redefine many LaTeX commands.
\definecolor{linkColor}{RGB}{6,125,233}
\hypersetup{%
  pdftitle={\plaintitle},
% Use \plainauthor for final version.
%  pdfauthor={\plainauthor},
  pdfauthor={\emptyauthor},
  pdfkeywords={\plainkeywords},
  pdfdisplaydoctitle=true, % For Accessibility
  bookmarksnumbered,
  pdfstartview={FitH},
  colorlinks,
  citecolor=black,
  filecolor=black,
  linkcolor=black,
  urlcolor=linkColor,
  breaklinks=true,
  hypertexnames=false
}

% create a shortcut to typeset table headings
% \newcommand\tabhead[1]{\small\textbf{#1}}

% End of preamble. Here it comes the document.
\begin{document}

\title{\plaintitle}

\numberofauthors{1}
\author{%
	\alignauthor{Dimitrios Aatos Ellinas\\
		\affaddr{Interactive Media Technology}\\
		\affaddr{KTH Royal Insitute of Technology}\\
		\affaddr{Stockholm, Sweden}\\
		\email{ellinas@kth.se}}\\
}

\maketitle

% \numberwithin{figure}{section}

\today
\begin{abstract}
	This paper investigates hybrid sound synthesis where physical modelling and abstract sound synthesis methods are combined.
	A modular approach to physical models is proposed and a model for string multiphonics is presented.
	% Digital waveguide models use recursive functions to model such strings. This paper introduces an explicit (non-recursive) formula for the touched string. This formulation can be easily rewritten as the output of an open (untouched) string with touch dependent coefficients and timeshifts, which effectively enables converting sounds of one kind to the other. Furthermore, the sounds to be converted are sounds of an open string only by assumption, in practice there're no such restrictions, this makes it possible to "perform" multiphonics with any pitched sound. Simplifying assumptions and necessary compromises are discussed as well as computation power issues and possible solutions.
\end{abstract}


% ACM Classfication

% \begin{CCSXML}
% <ccs2012>
% <concept>
% <concept_id>10003120.10003121</concept_id>
% <concept_desc>Human-centered computing~Human computer interaction (HCI)</concept_desc>
% <concept_significance>500</concept_significance>
% </concept>
% <concept>
% <concept_id>10003120.10003121.10003125.10011752</concept_id>
% <concept_desc>Human-centered computing~Haptic devices</concept_desc>
% <concept_significance>300</concept_significance>
% </concept>
% <concept>
% <concept_id>10003120.10003121.10003122.10003334</concept_id>
% <concept_desc>Human-centered computing~User studies</concept_desc>
% <concept_significance>100</concept_significance>
% </concept>
% </ccs2012>
% \end{CCSXML}

% \ccsdesc[500]{Human-centered computing~Human computer interaction (HCI)}
% \ccsdesc[300]{Human-centered computing~Haptic devices}
% \ccsdesc[100]{Human-centered computing~User studies}

% Author Keywords
\keywords{\plainkeywords}

% Print the classficiation codes
\printccsdesc

\section{Introduction}
% https://www.mdpi.com/2076-3417/6/5/143
The emergence of \textit{physical modeling sound synthesis} (or \text{physical modeling synthesis}) has enabled an intermediate space between itself and the preexisting sound synthesis techniques (additive, subtractive etc.) from hereon referred to as \textit{abstract synthesis}.
An example of this can be seen in robot voices, where models of the human vocal tract are combined with synthesized sounds totally unrelated to vocal folds.
This intermediate space can be attractive for creative purposes, since it provides a broad design space (\textit{abstract synthesis}), while being able to produce sounds that retain some physicality.
Incorporating physicality in sound synthesis serves more than just aesthetics.
Physics-informed sound features can also be suitable for information encoding due to their recognizability and their cross-modal correlations, making them useful in sonification and interaction design.
Cases where \textit{abstract} and \textit{physical modelling synthesis} is combined will be called \textit{physical model-abstract} (PMA) hybrids.

Finding the physical model of a desired feature and combining it with \textit{abstract synthesis} might not be a straight forward process.
Physical models are typically modelling an entire instrument rather than separate features and often use physical quantities other than air pressure (sound).
Obtaining a model only for a feature requires decomposition of the instrument model for the desired feature to be abstracted, and further adaptation for making the feature transferable to abstract sound synthesis.
Efficiency and other kinds of hybrids have motivated research in decomposition of physical models \cite{erkut_modular_2005,karjalainen_plucked-string_1998} producing findings usable in PMA hybrids.
This paper aims to point the potential of decomposed physical models for constructing PMA hybrids, and proposes an abstracted physical model for the effect of a lightly touching finger on a string.

Lightly touching a vibrating string is a practice associated with a number of string instrument playing techniques.
Depending on the touching position and the touching agent, a different technique is performed
Flageolet tones (harmonics) are performed by lightly touching a string with a finger, on specific fractions of its length.
Flageolet tones have a pitch much higher than the original string and a different timbre, often compared to a flute or a whistle.
(multiphonics definition).
Prepared strings is another technique where instead of a finger, a variety of objects such as rubbers, bolts or crocodile clips may be used on the string, the position of the object might be either that of an multiphonic or a harmonic.

\section{The lightly touched string}

This paper relies on \textit{digital waveguide} (DWG) synthesis \cite{smith_physical_1992}, a \textit{physical modelling} technique that employs D'Alambert's principle to decompose a standing wave (e.g. a vibrating string) into the sum of two travelling waves propagating in opposite directions.
All parts of the model are described in terms of traveling waves, and only in the final step are these waves combined to generate the physical motion of the string.
Propagation losses are modelled with filters, and termination reflections are implemented with a direction inversion, a reflection loss filter and a sign inversion (often implemented as part of the loss filter).
Figure \ref{fig:pickup} depicts a DWG model of a simple plucked string with a pickup output.
Although the string touching agent may vary, it will be referred to as the \textit{finger}.
The terms \textit{bridge} and \textit{nut} will be used for the left and the right termination, respectively, to reflect the structure of a string instrument.

\begin{figure}[h]
	\centering
	\scalebox{0.75}{\input{figures/wg.tex}}
	\caption{
		A digital waveguide model of a string with a pickup output.
		Where $N$ is the duration of a roundtrip in samples.
	}
	\label{fig:pickup}
\end{figure}

The touching point has been modelled in DWG synthesis as a three-port scattering-junction (SJ) \cite{scavone_digital_1997, valimaki_modeling_1993}.
This splits the model into three waveguides meeting at the SJ, one leading to the \textit{nut}, one leading to the \textit{bridge} and one leading to the \textit{finger}.
Since the \textit{finger} waveguide contains only a lossless reflection the SJ can be simplified as suggested in \cite{pakarinen_physical_2005}.
A string model with a simplified \textit{finger} SJ is depicted in fig. \ref{fig:waveguide_sj}.
The SJ coefficients $\rho_1 - \rho_4$ are defined in \cite{pakarinen_physical_2005} as

\begin{align} \label{eq:rhoCoeff}
	\rho_1 & = \frac{Z_1-Z_2-Z_3}{Z_1+Z_2+Z_3},       &
	\rho_2 & = \frac{Z_1-Z_2-Z_3}{Z_1+Z_2+Z_3},\notag   \\[1em]
	\rho_3 & = \frac{Z_1-Z_2-Z_3}{Z_1+Z_2+Z_3},       &
	\rho_3 & = \frac{Z_1-Z_2-Z_3}{Z_1+Z_2+Z_3},
\end{align}
where $Z_1$, $Z_2$ and $Z_3$ denote the impedance of the \textit{bridge}, \textit{nut} and \textit{finger} waveguides, respectively.
As the \textit{bridge} and \textit{nut} waveguides are part of the same string, their impedances should be equal, thus we have $Z_1=Z_2$.
Consequently, this equality leads to $\rho_1=\rho_4$ and $\rho_2=\rho_3$, leaving only coefficients $\rho_1$ and $\rho_2$.
Both can be expressed in relation to

\begin{equation} \label{eq:rho}
	\rho=\frac{Z_3}{2Z_1+Z_3}
\end{equation}
as
\begin{equation}
	\rho_1=-\rho \text{ and } \rho_2=1-\rho.
\end{equation}
The impedance $Z_3$ of the \textit{finger} waveguide varies depending on the pressure applied to the string.
The state of the SJ should span from disabled (no \textit{finger}) to a total reflection (the \textit{finger} acts as a termination), this implies that $0 \leq \rho \leq 1$.

\begin{figure}[h]
	\centering
	\scalebox{0.56}{\input{figures/wg-sj.tex}}
	\caption{A digital waveguide model with a scattering junction.}
	\label{fig:waveguide_sj}
\end{figure}

To reduce the computational complexity of the proposed model, the scattering of waves from the nut to the finger is disregarded.
This means that no reflections or coefficient multiplications occur from \textit{nut} to \textit{bridge}.
This SJ will be referred to as the \textit{single-sided} SJ, a depiction can be seen in fig. \ref{fig:waveguide_simple_sj}.
Although this might seem like a crude simplification, comparing audio outputs reveals that the only discernible effect of the \textit{single-sided} SJ is a ``metallic'' or ``rough'' quality, which is an acceptable compromise for the purpose of this paper.
\begin{figure}[h]
	\centering
	\scalebox{0.6}{\input{figures/wg-simple-sj.tex}}
	\caption{A digital waveguide with a simplified scattering junction.}
	\label{fig:waveguide_simple_sj}
\end{figure}

As previously mentioned, the SJ is the meeting point for three waveguides.
This results in the formation of one loop for each combination of waveguides, namely the \textit{bridge-finger} loop, the \textit{bridge-nut} loop, and the \textit{finger-nut} loop.
Using the \textit{single-sided} SJ eliminates the \textit{finger-nut} loop, leaving only the \textit{bridge-finger} and the \textit{bridge-nut} loop, also referred to as $F$ and $N$ roundtrips.

\section{model decomposition}

Modular DWG models have been referred to as \textit{single delay-loop} (SDL) models \cite{karjalainen_plucked-string_1998,pakarinen_physical_2005}.
This terminology refers to the implementation of the string roundtrip using a single delay line (as shown in Figure \ref{fig:sdl_string_loop}), in contrast to the conventional \textit{dual-delay} DWG (fig. \ref{fig:pickup}).
Even when more than one delay line is used in simplified versions of complex models, they might still be referred to as SDL models.
\begin{figure}[h]
	\centering
	\scalebox{0.75}{\input{figures/sdl.tex}}
	\caption{SDL string loop.}
	\label{fig:sdl_string_loop}
\end{figure}

% wavetable synthesis, phase accumulator, unipolar sawtooth wave

In \cite{karjalainen_plucked-string_1998} a plucked string DWG model is SDL models, namely, \textit{plucking position}, \textit{string loop}, and \textit{pickup output}.
For a lightly touched string model, the same \textit{plucking position} and \textit{pickup output} modules can be used.
However, the \textit{string loop} module needs to be modified to accommodate the touching finger.
Figure \ref{fig:sdl_simple_sj} depicts a SDL model of a \textit{touched string loop} using a \textit{single-sided} SJ.
Note that this module models the combined effect of the string and the \textit{finger}.
To isolate the specific effect of the \textit{finger}, further decomposition is necessary.
\begin{figure*}[h]
	\centering
	\scalebox{0.8}{\input{figures/sdl-simple-sj.tex}}
	\caption{String loop with a scattering junction.}
	\label{fig:sdl_simple_sj}
\end{figure*}
% A formula for the impulse response of a lightly touched string is proposed in \cite{guettler_bowed-string_2012}.
To gain insight into the touched string loop, a time domain transfer function is proposed:
\begin{equation} \label{eq:explicit}
	\sum_{k=0}^{\lfloor \frac{n}{T_F} \rfloor}\left(y[n - (kT_F + mT_N)]\binom{m+k}{k} (1 - \rho)^{k} \rho^mG_{k,m}\right),
\end{equation}
\begin{equation*}
	\textrm{for } T_F<T_N<n \textrm{ and } 0\leq\rho\leq1\notag,
\end{equation*}
Here, the variables and terms used are defined as follows:
\begin{itemize}
	\setlength\itemsep{0.1em}
	\item $n$ denotes the current time in samples,
	\item $T_N$ and $T_F$ denote the duration of the $N$ and $F$ roundtrips in samples, respectively,
	\item $\rho$ is the finger pressure coefficient defined in (\ref{eq:rho}),
	\item $G_{k,m}$ denotes losses for each roundtrip combination and
	\item $m$ is defined as
\end{itemize}
\begin{equation}
	m = \lfloor \frac{n - kT_F}{T_N} \rfloor.
\end{equation}
The initial values are given by the function $y[n]$ for $0 \leq n < T_F$.
The argument of the summation in (\ref{eq:explicit}) can be split into four parts,
\begin{align}
	\label{eq:shifts} & \bullet\qquad\textrm{shifts }       &  & y[n - (kT_F + mT_N)],  \\[1em]
	\label{eq:perm}   & \bullet\qquad\textrm{permutations } &  & \binom{m+k}{k},        \\[1em]
	\label{eq:coef}   & \bullet\qquad\textrm{coefficients } &  & (1 - \rho)^{k} \rho^m, \\[1em]
	\label{eq:loss}   & \bullet\qquad\textrm{and losses }   &  & G_{k,m}.
\end{align}
Firstly, (\ref{eq:shifts}) shifts the initial values forward in time by an amount proportional to the number of $N$ and $F$ roundtrips performed at the current time.
For a given time $n$, the maximum number of $F$ roundtrips is given by $\lfloor \frac{n}{T_F} \rfloor$.
Here, $k$ takes all integer values in the range $[0..\lfloor \frac{n}{T_F} \rfloor]$.
Variable $m$ represents the maximum number of $N$ roundtrips that can be performed after $k$ $F$ roundtrips, within the available time.
These variables, $m$ and $k$, are defined in a manner that solves a combinatorial optimization problem subject to the following constraint: $n - (kT_F + mT_N) < T_N$.

The shifts account for all combinations of $F$ and $N$ roundtrips, however, permutations within each combination are not currently considered.
Let's consider a case where $k = 2$ and $m = 1$.
In this case, three permutations of roundtrips are performed simultaneously, namely NFF, FNF, and FFN.
It is important to note that since $k$ and $m$ remain the same, each permutation yields an identical signal.
Therefore, obtaining the sum of all three permutations is simply a matter of tripling the amplitude.
Generalizing, accounting for permutations is achieved by multiplying the shifted signal by the number of allowed permutations.
This number, for a given $k$ and $m$, can be obtained using the binomial coefficient as shown in (\ref{eq:perm}).

Each roundtrip involves a SJ coefficient as defined in (\ref{eq:rho}).
After completing a certain number of roundtrips ($k$ for $F$ and $m$ for $N$ roundtrips), the cumulative effect of the coefficients can be computed as demonstrated in (\ref{eq:coef}).

Lastly, (\ref{eq:loss}) represents the roundtrip losses for any given $k$ and $m$.
Losses are considered as unknown coefficients since their implementation might vary depending on the models approach.
Not defining a specific loss filter will also proves convenient in the next section where the effect of the touching finger is applied to sounds that have already undergone some unknown roundtrip losses.

\begin{figure}[h]
	\centering
	\scalebox{1}{\input{figures/triangle.tex}}
	\caption{}
	\label{fig:triangle}
\end{figure}

On figure \ref{fig:triangle} depicts a diagram of the

\section{Multiphonics synthesis}
As stated before, (\ref{eq:explicit}) is a formula for

isolated touching finger model

\begin{equation}
	\sum_{k=0}^{\lfloor \frac{n}{T_F} \rfloor}\left(y[n + k(T_N-T_F)]\binom{m+k}{k} (1 - \rho)^{k} \rho^m\right)
\end{equation}

% \input{table.tex}

real time implementation

\begin{equation}
	\sum_{k=0}^{\lfloor \frac{n}{T_F} \rfloor}\left(y[n - \left\{ k\frac{T_F}{T_N}\right\} T_N] \binom{m+k}{k} (1 - \rho)^{k} \rho^m\right)
\end{equation}

% \begin{figure*}
% 	\centering
% 	\scalebox{0.8}{\input{figures/sdl-sj.tex}}
% 	\label{fig:sdl_sj}
% 	\caption{String loop with a scattering junction.}
% \end{figure*}

% \subsection{Ontological challenges}
% Using an abstract sound instead of suitable models is not a mere matter of replacement, justifying this choice raises ontological issues. Since D'Alambert's principle is an arbitrary method of analysis 

% REFERENCES FORMAT
% References must be the same font size as other body text.
\bibliographystyle{SIGCHI-Reference-Format}
\bibliography{bibliography.bib}

\end{document}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% End:
